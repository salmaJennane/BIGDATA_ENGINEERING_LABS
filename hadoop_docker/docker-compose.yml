version: '3.8'

services:
  # ===============================
  # Hadoop Master (NameNode)
  # ===============================
  hadoop-master:
    image: yassern1/hadoop-spark-jupyter:1.0.3
    container_name: hadoop-master
    hostname: hadoop-master
    networks:
      - hadoop
    ports:
      - "9870:9870"   # NameNode Web UI
      - "8088:8088"   # YARN ResourceManager UI
      - "7077:7077"   # Spark Master
      - "19888:19888" # MapReduce JobHistory Server
      - "8080:8080"   # Spark Master Web UI
      - "9000:9000"   # HDFS
      - "9092:9092"   # Kafka Broker 0
      - "2181:2181"   # Zookeeper
    volumes:
      - /c/Users/hp/OneDrive/Documents/hadoop_project:/shared_volume
    stdin_open: true
    tty: true
    command: tail -f /dev/null

  # ===============================
  # Hadoop Slave 1 (DataNode)
  # ===============================
  hadoop-slave1:
    image: yassern1/hadoop-spark-jupyter:1.0.3
    container_name: hadoop-slave1
    hostname: hadoop-slave1
    networks:
      - hadoop
    ports:
      - "8040:8042"   # NodeManager Web UI
      - "9093:9093"   # Kafka Broker 1
    stdin_open: true
    tty: true
    command: tail -f /dev/null
    depends_on:
      - hadoop-master

  # ===============================
  # Hadoop Slave 2 (DataNode)
  # ===============================
  hadoop-slave2:
    image: yassern1/hadoop-spark-jupyter:1.0.3
    container_name: hadoop-slave2
    hostname: hadoop-slave2
    networks:
      - hadoop
    ports:
      - "8041:8042"   # NodeManager Web UI
      - "9094:9094"   # Kafka Broker 2
    stdin_open: true
    tty: true
    command: tail -f /dev/null
    depends_on:
      - hadoop-master

  # ===============================
  # Kafka UI
  # ===============================
  kafka-ui:
    image: provectuslabs/kafka-ui:latest
    container_name: kafka-ui
    hostname: kafka-ui
    networks:
      - hadoop
    ports:
      - "8081:8080"   # Kafka UI Web Interface
    environment:
      - KAFKA_CLUSTERS_0_NAME=hadoop-kafka-cluster
      - KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS=hadoop-master:9092
      - KAFKA_CLUSTERS_0_ZOOKEEPER=hadoop-master:2181
    depends_on:
      - hadoop-master

# ===============================
# Network Configuration
# ===============================
networks:
  hadoop:
    driver: bridge